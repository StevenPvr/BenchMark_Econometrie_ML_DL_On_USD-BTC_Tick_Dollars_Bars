"""Configuration for feature analysis module.

This module re-exports constants and paths from the central configuration
files for backward compatibility and convenience.

All constants are defined in src/constants.py.
All paths are defined in src/path.py.
"""

from __future__ import annotations

import os

from src.constants import (
    DEFAULT_RANDOM_STATE,
    # Parallelization
    ANALYSE_FEATURES_CHUNK_SIZE as CHUNK_SIZE,
    ANALYSE_FEATURES_JOBLIB_BACKEND as JOBLIB_BACKEND,
    ANALYSE_FEATURES_JOBLIB_VERBOSITY as JOBLIB_VERBOSITY,
    # Data sampling
    ANALYSE_FEATURES_SAMPLE_FRACTION as DATASET_SAMPLE_FRACTION,
    # Correlation
    CORRELATION_SIGNIFICANT_THRESHOLD,
    CORRELATION_HIGH_THRESHOLD,
    CORRELATION_DROP_THRESHOLD,
    MI_N_NEIGHBORS,
    # Clustering
    CLUSTER_LINKAGE,
    UMAP_N_NEIGHBORS,
    UMAP_MIN_DIST,
    UMAP_N_COMPONENTS,
    UMAP_METRIC,
    TSNE_PERPLEXITY,
    TSNE_N_ITER,
    # Temporal
    TEMPORAL_ACF_LAGS as ACF_LAGS,
    TEMPORAL_ROLLING_WINDOWS,
    TEMPORAL_N_PERIODS as N_TEMPORAL_PERIODS,
    # Target
    TARGET_COLUMN_DEFAULT as TARGET_COLUMN,
    TARGET_TOP_N_FEATURES as TOP_N_FEATURES,
    TARGET_SCATTER_SAMPLE_SIZE as SCATTER_SAMPLE_SIZE,
    # VIF
    VIF_HIGH_THRESHOLD,
    VIF_CRITICAL_THRESHOLD,
    CONDITION_NUMBER_MODERATE,
    CONDITION_NUMBER_HIGH,
    # Feature selection
    ANALYSE_FEATURES_SAVE_BATCH_SIZE as SAVE_BATCH_SIZE,
    # Visualization
    ANALYSE_FEATURES_FIGSIZE_HEATMAP as FIGSIZE_HEATMAP,
    ANALYSE_FEATURES_FIGSIZE_BAR as FIGSIZE_BAR,
    ANALYSE_FEATURES_FIGSIZE_SCATTER as FIGSIZE_SCATTER,
    ANALYSE_FEATURES_FIGSIZE_DENDROGRAM as FIGSIZE_DENDROGRAM,
    ANALYSE_FEATURES_FIGSIZE_ACF as FIGSIZE_ACF,
    ANALYSE_FEATURES_PNG_DPI as PNG_DPI,
    COLORSCALE_CORRELATION,
    COLORSCALE_SEQUENTIAL,
)
from src.path import (
    ANALYSE_FEATURES_DIR,
    ANALYSE_FEATURES_JSON_DIR as RESULTS_JSON_DIR,
    ANALYSE_FEATURES_PLOTS_HTML_DIR as PLOTS_HTML_DIR,
    ANALYSE_FEATURES_PLOTS_PNG_DIR as PLOTS_PNG_DIR,
    ANALYSE_FEATURES_CACHE_DIR as CACHE_DIR,
    CORRELATION_RESULTS_JSON,
    MULTICOLLINEARITY_RESULTS_JSON,
    TARGET_RESULTS_JSON,
    CLUSTERING_RESULTS_JSON,
    TEMPORAL_RESULTS_JSON,
    ANALYSE_FEATURES_SUMMARY_JSON as SUMMARY_JSON,
    ANALYSE_FEATURES_INPUT_DATASETS as INPUT_DATASETS,
    ANALYSE_FEATURES_OUTPUT_DATASETS as OUTPUT_DATASETS,
    DATASET_FEATURES_CLEAR_PARQUET,
    DATASET_FEATURES_LINEAR_CLEAR_PARQUET,
    DATASET_FEATURES_LSTM_CLEAR_PARQUET,
    DATA_DIR,
)

# Legacy aliases for backward compatibility
SPEARMAN_HIGH_CORR_THRESHOLD: float = CORRELATION_HIGH_THRESHOLD
MI_RANDOM_STATE: int = DEFAULT_RANDOM_STATE
TSNE_RANDOM_STATE: int = DEFAULT_RANDOM_STATE
ROLLING_WINDOWS: list[int] = list(TEMPORAL_ROLLING_WINDOWS)

# Number of parallel jobs (-1 = all cores)
N_JOBS: int = -1 if os.cpu_count() else 1
N_CORES: int = os.cpu_count() or 1

# Re-export all symbols for backward compatibility
__all__ = [
    # Parallelization
    "N_JOBS",
    "N_CORES",
    "CHUNK_SIZE",
    "JOBLIB_BACKEND",
    "JOBLIB_VERBOSITY",
    # Paths
    "ANALYSE_FEATURES_DIR",
    "RESULTS_JSON_DIR",
    "PLOTS_HTML_DIR",
    "PLOTS_PNG_DIR",
    "CACHE_DIR",
    "CORRELATION_RESULTS_JSON",
    "MULTICOLLINEARITY_RESULTS_JSON",
    "TARGET_RESULTS_JSON",
    "CLUSTERING_RESULTS_JSON",
    "TEMPORAL_RESULTS_JSON",
    "SUMMARY_JSON",
    "INPUT_DATASETS",
    "OUTPUT_DATASETS",
    # Sampling
    "DATASET_SAMPLE_FRACTION",
    # Correlation
    "CORRELATION_SIGNIFICANT_THRESHOLD",
    "CORRELATION_HIGH_THRESHOLD",
    "CORRELATION_DROP_THRESHOLD",
    "SPEARMAN_HIGH_CORR_THRESHOLD",
    "MI_N_NEIGHBORS",
    "MI_RANDOM_STATE",
    # Clustering
    "CLUSTER_LINKAGE",
    "UMAP_N_NEIGHBORS",
    "UMAP_MIN_DIST",
    "UMAP_N_COMPONENTS",
    "UMAP_METRIC",
    "TSNE_PERPLEXITY",
    "TSNE_N_ITER",
    "TSNE_RANDOM_STATE",
    # Temporal
    "ACF_LAGS",
    "ROLLING_WINDOWS",
    "N_TEMPORAL_PERIODS",
    # Target
    "TARGET_COLUMN",
    "TOP_N_FEATURES",
    "SCATTER_SAMPLE_SIZE",
    # VIF
    "VIF_HIGH_THRESHOLD",
    "VIF_CRITICAL_THRESHOLD",
    "CONDITION_NUMBER_MODERATE",
    "CONDITION_NUMBER_HIGH",
    # Feature selection
    "SAVE_BATCH_SIZE",
    # Visualization
    "FIGSIZE_HEATMAP",
    "FIGSIZE_BAR",
    "FIGSIZE_SCATTER",
    "FIGSIZE_DENDROGRAM",
    "FIGSIZE_ACF",
    "PNG_DPI",
    "COLORSCALE_CORRELATION",
    "COLORSCALE_SEQUENTIAL",
    # Functions
    "ensure_directories",
]


def ensure_directories() -> None:
    """Create all output directories if they don't exist."""
    dirs_to_create = [
        ANALYSE_FEATURES_DIR,
        RESULTS_JSON_DIR,
        PLOTS_HTML_DIR,
        PLOTS_PNG_DIR,
        CACHE_DIR,
    ]
    for dir_path in dirs_to_create:
        dir_path.mkdir(parents=True, exist_ok=True)
